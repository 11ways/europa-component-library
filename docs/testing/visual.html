<!DOCTYPE html>
<html lang="en" dir="ltr" class="no-js">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script>
    window.frctl = {
        env: 'static'
    };
    </script>
    <script>var cl = document.querySelector('html').classList; cl.remove('no-js'); cl.add('has-js');</script>
    <link rel="shortcut icon" href="../../themes/ecl-fractal-theme/favicon.ico" type="image/ico">

<link rel="stylesheet" href="../../themes/ecl-fractal-theme/css/blue.css?cachebust=0.3.1" type="text/css">


<title>Visual regression testing | Europa Component Library</title>

</head>
<body>



<div class="Frame" id="frame">

    <div class="Frame-header">
        <div class="Header">
    <strong><a href="https://ec-europa.github.io/europa-component-library/" class="Header-title">Europa Component Library</a></strong>
    <a href="../../docs" class="Header-title">Documentation</a>
    <a href="../../components" class="Header-title">Components</a>
    <a href="https://github.com/ec-europa/europa-component-library" class="Header-title">GitHub</a>
</div>

    </div>

    <div class="Frame-body" data-role="body">

        <div class="Frame-panel Frame-panel--main" data-role="main">
            <div class="Frame-inner" id="pjax-container">
            

<div class="Document">

    <div class="Document-header">
        
        <h1 class="Document-title">Visual regression testing</h1>
        


        
    </div>

    <div class="Document-content">

    

<div class="Prose">



    
    
    <p>We test our components in order to catch visual regressions before they hit the production. We use <a href="http://webdriver.io/">WebdriverIO</a> to drive those tests on <a href="https://saucelabs.com/">Sauce Labs</a>‘s Selenium cloud-based solution:</p>
<p>Here are the results of the latest build:</p>
<p><a href="https://saucelabs.com/u/europa-component-library"><img src="https://saucelabs.com/browser-matrix/europa-component-library.svg" alt="Build Status"></a></p>
<h2 id="how-to-test-a-new-component">How to test a new component</h2>
<p>Testing a new component is quite simple. Follow the guide!</p>
<h3 id="write-a-test">Write a test</h3>
<p>Tests are located under <code>test/functional</code>. Create a new <code>my-component.js</code> file here and paste:</p>
<code class="lang-js"><pre>describe(<span class="hljs-string">'my-component'</span>, () =&gt; {
  before(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-comment">// Set viewport size</span>
    browser.setViewportSize({
      <span class="hljs-attr">width</span>: <span class="hljs-number">1400</span>,
      <span class="hljs-attr">height</span>: <span class="hljs-number">600</span>,
    });

    browser.pause(<span class="hljs-number">1000</span>);

    <span class="hljs-comment">// Go to url</span>
    browser.url(<span class="hljs-string">'my-component.html'</span>);

    <span class="hljs-comment">// Make sure the browser has finished painting</span>
    browser.pause(<span class="hljs-number">1000</span>);
  });

  <span class="hljs-comment">// Normal state</span>
  context(<span class="hljs-string">'with plain state'</span>, () =&gt; {
    it(<span class="hljs-string">'should match the reference screenshot'</span>, () =&gt; {
      <span class="hljs-keyword">const</span> screenshots = browser.checkDocument({
        <span class="hljs-attr">name</span>: <span class="hljs-string">'my-component'</span>,
      });
      expect(screenshots).to.matchReference();
    });
  });
});</pre></code><p>Of course, replace <code>my-component</code> by the name of the actual component and make sure the URL you provide exists.</p>
<p><strong>Under the hood, the URL will be prefixed by <code>http://localhost:3000/components/preview/</code></strong>.</p>
<h3 id="get-the-reference-screenshots">Get the reference screenshots</h3>
<p>In order to get the reference screenshots, you have to run the tests locally. On the first run, if the reference screenshots don’t exist, they will be created. You need to create a Sauce Labs account and then create a new token.</p>
<h4 id="configure-sauce-labs">Configure Sauce Labs</h4>
<p>In your <code>.env</code> file, provide the information about your own Sauce Labs account.</p>
<code><pre><span class="hljs-attr">SAUCE_USERNAME</span>=username
<span class="hljs-attr">SAUCE_ACCESS_KEY</span>=my-sauce-labs-access-key</pre></code><p>Then, build the style guide with <code>yarn dist</code> and run: <code>yarn test:functional</code>.</p>
<p>Tip: it can take a while to run all the tests, but you can also target your test only:</p>
<code><pre>yarn <span class="hljs-built_in">test</span>:functional -- --spec ./<span class="hljs-built_in">test</span>/functional/my-component.js</pre></code><p>That’s it!</p>

    


</div>



    </div>

</div>


            </div>
        </div>

        <div class="Frame-handle" data-role="frame-resize-handle"></div>

        <div class="Frame-panel Frame-panel--sidebar" data-role="sidebar">
            <nav class="Navigation">
                
<div class="Navigation-group">

<div class="Tree" data-behaviour="tree" id="tree-docs">
    <h3 class="Tree-title">documentation</h3>
    <ul class="Tree-items Tree-depth-1">
        
    
        
        
        <li class="Tree-item Tree-entity" data-role="item">
            <a class="Tree-entityLink" href="../overview" data-pjax>
                
                <span>Overview</span>
            </a>
        </li>
        
    
        
        
        <li class="Tree-item Tree-entity" data-role="item">
            <a class="Tree-entityLink" href="../atomic" data-pjax>
                
                <span>Atomic</span>
            </a>
        </li>
        
    
        
        <li class="Tree-item Tree-collection" data-behaviour="collection" id="tree-docs-collection-conventions">
            <h4 class="Tree-collectionLabel" data-role="toggle">
                
                <span>Conventions</span>
            </h4>
            <ul class="Tree-collectionItems Tree-depth-2" data-role="items">
            
            
            
            
    
        
        
        <li class="Tree-item Tree-entity" data-role="item">
            <a class="Tree-entityLink" href="../conventions/git" data-pjax>
                
                <span>Git Commit</span>
            </a>
        </li>
        
    
        
        
        <li class="Tree-item Tree-entity" data-role="item">
            <a class="Tree-entityLink" href="../conventions/javascript" data-pjax>
                
                <span>JavaScript</span>
            </a>
        </li>
        
    
        
        
        <li class="Tree-item Tree-entity" data-role="item">
            <a class="Tree-entityLink" href="../conventions/scss" data-pjax>
                
                <span>SCSS</span>
            </a>
        </li>
        
    

            </ul>
        </li>
        
    
        
        <li class="Tree-item Tree-collection" data-behaviour="collection" id="tree-docs-collection-testing">
            <h4 class="Tree-collectionLabel" data-role="toggle">
                
                <span>Testing</span>
            </h4>
            <ul class="Tree-collectionItems Tree-depth-2" data-role="items">
            
            
            
            
    
        
        
        <li class="Tree-item Tree-entity is-current" data-state="current" data-role="item">
            <a class="Tree-entityLink" href="" data-pjax>
                
                <span>Visual regression</span>
            </a>
        </li>
        
    

            </ul>
        </li>
        
    

    </ul>
</div>

</div>


            </nav>
        </div>
    </div>
</div>




<script src="../../themes/ecl-fractal-theme/js/ecl-fractal-theme.js?cachebust=0.3.1"></script>



</body>
</html>
