<!DOCTYPE html>
<html lang="en" dir="ltr" class="no-js">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script>
    window.frctl = {
        env: 'static'
    };
    </script>
    <script>var cl = document.querySelector('html').classList; cl.remove('no-js'); cl.add('has-js');</script>
    <link rel="shortcut icon" href="../../themes/ecl-fractal-theme/favicon.ico" type="image/ico">

<link rel="stylesheet" href="../../themes/ecl-fractal-theme/ecl/ecl.css?cachebust=0.5.1" type="text/css">

<link rel="stylesheet" href="../../themes/ecl-fractal-theme/css/blue.css?cachebust=0.5.1" type="text/css">


<title>Visual regression testing | Europa Component Library</title>

</head>
<body class="language-en">



<header class="ecl-site-header" role="banner">
  <div class="container-fluid ecl-site-header__container">
    <a href="https://ec.europa.eu" class="ecl-logo ecl-logo--logotype ecl-site-header__logo" title="Home - European Commission">
      <span class="ecl-sr-only">Home - European Commission</span>
    </a>

    <section class="ecl-site-header__top-bar" aria-label="Site tools">
      <div class="ecl-site-header__top-bar__wrapper">
        <div class="ecl-lang-select-sites">
          <a href="#" class="ecl-lang-select-sites__link">
            <span class="ecl-lang-select-sites__label">English</span>
            <span class="ecl-lang-select-sites__code">
              <span class="ecl-icon ecl-icon--language ecl-lang-select-sites__icon"></span>
              <span class="ecl-lang-select-sites__code-text">en</span>
            </span>
          </a>
        </div>

        <form class="ecl-search-form">
          <label class="ecl-search-form__textfield-wrapper">
            <span class="ecl-sr-only">Search this website</span>
            <input type="ecl-search" id="search-components" class="ecl-search-form__textfield ecl-text-input" size="60" maxlength="128" title="ecl-search">
            <script id="searchIndexPath" type="application/json">{ "path": "../../assets/searchIndex.json" }</script>
          </label>

          <button class="ecl-search-form__button ecl-button ecl-button--form" value="ecl-search" type="submit">Search</button>
        </form>
      </div>
    </section>
  </div>
</header>

<div id="frame">

    <div class="Frame-header">
        <div class="Header">
    <strong><a href="https://ec-europa.github.io/europa-component-library/" class="Header-title">Europa Component Library</a></strong>
    <a href="../../docs" class="Header-title">Documentation</a>
    <a href="../../components" class="Header-title">Components</a>
    <a href="https://github.com/ec-europa/europa-component-library" class="Header-title">GitHub</a>
</div>

    </div>

    <div class="Frame-body" data-role="body">

        <div class="Frame-panel Frame-panel--main" data-role="main">
            <div class="Frame-inner" id="pjax-container">
            

<div class="Document">

    <div class="Document-header">
        
        <h1 class="Document-title">Visual regression testing</h1>
        


        
    </div>

    <div class="Document-content">

    

<div class="Prose">



    
    
    <p>We test our components in order to catch visual regressions before they hit the production. We use <a href="http://webdriver.io/">WebdriverIO</a> to drive those tests on <a href="https://saucelabs.com/">Sauce Labs</a>‘s Selenium cloud-based solution:</p>
<p>Here are the results of the latest build:</p>
<p><a href="https://saucelabs.com/u/europa-component-library"><img src="https://saucelabs.com/browser-matrix/europa-component-library.svg" alt="Build Status"></a></p>
<h2 id="how-to-test-a-new-component">How to test a new component</h2>
<p>Testing a new component is quite simple. Follow the guide!</p>
<h3 id="write-a-test">Write a test</h3>
<p>Tests are located under <code>test/functional</code>. Create a new <code>my-component.js</code> file here and paste:</p>
<code class="lang-js"><pre>describe(<span class="hljs-string">'my-component'</span>, () =&gt; {
  before(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-comment">// Set viewport size</span>
    browser.setViewportSize({
      <span class="hljs-attr">width</span>: <span class="hljs-number">1400</span>,
      <span class="hljs-attr">height</span>: <span class="hljs-number">600</span>,
    });

    browser.pause(<span class="hljs-number">1000</span>);

    <span class="hljs-comment">// Go to url</span>
    browser.url(<span class="hljs-string">'my-component.html'</span>);

    <span class="hljs-comment">// Make sure the browser has finished painting</span>
    browser.pause(<span class="hljs-number">1000</span>);
  });

  <span class="hljs-comment">// Normal state</span>
  context(<span class="hljs-string">'with plain state'</span>, () =&gt; {
    it(<span class="hljs-string">'should match the reference screenshot'</span>, () =&gt; {
      <span class="hljs-keyword">const</span> screenshots = browser.checkDocument({
        <span class="hljs-attr">name</span>: <span class="hljs-string">'my-component'</span>,
      });
      expect(screenshots).to.matchReference();
    });
  });
});</pre></code><p>Of course, replace <code>my-component</code> by the name of the actual component and make sure the URL you provide exists.</p>
<p><strong>Under the hood, the URL will be prefixed by <code>http://localhost:3000/components/preview/</code></strong>.</p>
<h3 id="get-the-reference-screenshots">Get the reference screenshots</h3>
<p>In order to get the reference screenshots, you have to run the tests locally. On the first run, if the reference screenshots don’t exist, they will be created. You need to create a Sauce Labs account and then create a new token.</p>
<h4 id="configure-sauce-labs">Configure Sauce Labs</h4>
<p>In your <code>.env</code> file, provide the information about your own Sauce Labs account.</p>
<code><pre><span class="hljs-attr">SAUCE_USERNAME</span>=username
<span class="hljs-attr">SAUCE_ACCESS_KEY</span>=my-sauce-labs-access-key</pre></code><p>Then, build the style guide with <code>yarn dist</code> and run: <code>yarn test:functional</code>.</p>
<p>Tip: it can take a while to run all the tests, but you can also target your test only:</p>
<code><pre>yarn <span class="hljs-built_in">test</span>:functional -- --spec ./<span class="hljs-built_in">test</span>/functional/my-component.js</pre></code><p>If everything went well, you should now have a new folder <code>./test/screenshots/reference/my-component</code> containing the reference screenshots. Add them to your Pull Request.</p>
<p>That’s it!</p>

    


</div>



    </div>

</div>


            </div>
        </div>

        <div class="Frame-handle" data-role="frame-resize-handle"></div>

        <div class="Frame-panel Frame-panel--sidebar" data-role="sidebar">
            <nav class="Navigation">
                
<div class="Navigation-group">

<div class="Tree" data-behaviour="tree" id="tree-docs">
    <h3 class="Tree-title">documentation</h3>
    <ul class="Tree-items Tree-depth-1">
        
    
        
        
        <li class="Tree-item Tree-entity" data-role="item">
            <a class="Tree-entityLink" href="../overview" data-pjax>
                
                <span>Overview</span>
            </a>
        </li>
        
    
        
        
        <li class="Tree-item Tree-entity" data-role="item">
            <a class="Tree-entityLink" href="../atomic" data-pjax>
                
                <span>Atomic</span>
            </a>
        </li>
        
    
        
        <li class="Tree-item Tree-collection" data-behaviour="collection" id="tree-docs-collection-conventions">
            <h4 class="Tree-collectionLabel" data-role="toggle">
                
                <span>Conventions</span>
            </h4>
            <ul class="Tree-collectionItems Tree-depth-2" data-role="items">
            
            
            
            
    
        
        
        <li class="Tree-item Tree-entity" data-role="item">
            <a class="Tree-entityLink" href="../conventions/git" data-pjax>
                
                <span>Git Commit</span>
            </a>
        </li>
        
    
        
        
        <li class="Tree-item Tree-entity" data-role="item">
            <a class="Tree-entityLink" href="../conventions/javascript" data-pjax>
                
                <span>JavaScript</span>
            </a>
        </li>
        
    
        
        
        <li class="Tree-item Tree-entity" data-role="item">
            <a class="Tree-entityLink" href="../conventions/scss" data-pjax>
                
                <span>SCSS</span>
            </a>
        </li>
        
    

            </ul>
        </li>
        
    
        
        <li class="Tree-item Tree-collection" data-behaviour="collection" id="tree-docs-collection-testing">
            <h4 class="Tree-collectionLabel" data-role="toggle">
                
                <span>Testing</span>
            </h4>
            <ul class="Tree-collectionItems Tree-depth-2" data-role="items">
            
            
            
            
    
        
        
        <li class="Tree-item Tree-entity is-current" data-state="current" data-role="item">
            <a class="Tree-entityLink" href="" data-pjax>
                
                <span>Visual regression</span>
            </a>
        </li>
        
    

            </ul>
        </li>
        
    

    </ul>
</div>

</div>


            </nav>
        </div>
    </div>

    <div class="Frame-footer">
        <footer class="ecl-footer">
    <div class="ecl-footers__site-corporate">
        <div class="ecl-container">
            <div class="ecl-row">
                <div class="ecl-col-sm ecl-footers__column">
                    <h4 class="ecl-h4 ecl-footers__title">European Commission</h4>
                    <ul class="ecl-footers__menu">
                        <li class="ecl-footers__menu-item">
                            <a href="#">Commission and it's priorities</a>
                        </li>
                        <li class="ecl-footers__menu-item">
                            <a href="#">Policies information and services</a>
                        </li>
                    </ul>
                </div>
                <div class="ecl-col-sm ecl-footers__column">
                    <h4 class="ecl-h4 ecl-footers__title">Follow the European Commission</h4>
                    <ul class="ecl-footers__menu ecl-list-inline">
                        <li class="ecl-footers__menu-item ecl-list-inline__item">
                            <a href="#"><span class="ecl-icon ecl-icon--facebook ecl-footers__social-icon"></span>Facebook</a>
                        </li>
                        <li class="ecl-footers__menu-item ecl-list-inline__item">
                            <a href="#"><span class="ecl-icon ecl-icon--twitter ecl-footers__social-icon"></span>Twitter</a>
                        </li>
                        <li class="ecl-footers__menu-item ecl-list-inline__item">
                            <a href="#">Other social media</a>
                        </li>
                    </ul>
                </div>
                <div class="ecl-col-sm ecl-footers__column">
                    <h4 class="ecl-h4 ecl-footers__title">European Union</h4>
                    <ul class="ecl-footers__menu">
                        <li class="ecl-footers__menu-item">
                            <a class="ecl-link--external" href="#">EU institutions</a>
                        </li>
                        <li class="ecl-footers__menu-item">
                            <a class="ecl-link--external" href="#">European Union</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <div class="ecl-footers__ec">
        <div class="ecl-container">
            <div class="ecl-row">
                <div class="ecl-col-sm">
                    <ul class="ecl-list-inline ecl-footers__menu">
                        <li class="ecl-list-inline__item ecl-footers__menu-item">
                            <a href="http://ec.europa.eu/info/about-commissions-new-web-presence_en" class="">About the Commission's new web presence</a>
                        </li>
                        <li class="ecl-list-inline__item ecl-footers__menu-item">
                            <a href="http://ec.europa.eu/info/resources-partners_en" class="">Resources for partners</a>
                        </li>
                        <li class="ecl-list-inline__item ecl-footers__menu-item">
                            <a href="http://ec.europa.eu/info/cookies_en" class="">Cookies</a>
                        </li>
                        <li class="ecl-list-inline__item ecl-footers__menu-item">
                            <a href="http://ec.europa.eu/info/legal-notice_en" class="">Legal notice</a>
                        </li>
                        <li class="ecl-list-inline__item ecl-footers__menu-item">
                            <a href="http://ec.europa.eu/info/contact_en" class="">Contact</a>
                        </li>
                        <li class="ecl-list-inline__item ecl-footers__menu-item">
                            <a href="http://ec.europa.eu/info/europa-analytics_en" class="">Europa Analytics</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</footer>

    </div>
</div>




<script src="../../themes/ecl-fractal-theme/js/ecl-fractal-theme.js?cachebust=0.5.1"></script>



</body>
</html>
