<!DOCTYPE html>
<html lang="en" dir="ltr" class="no-js">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="theme-color" content="#034ea1">
    <meta name="msapplication-TileColor" content="#034ea1">
    <script>
    window.frctl = {
        env: 'static'
    };
    </script>
    <script>var cl = document.querySelector('html').classList; cl.remove('no-js'); cl.add('has-js');</script>
    <link rel="apple-touch-icon" sizes="144x144" href="../../themes/ecl-fractal-theme/img/favicon/apple-touch-icon-144x144.png">
<meta name="msapplication-square70x70logo" content="../../themes/ecl-fractal-theme/img/favicon/mstile-70x70.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../themes/ecl-fractal-theme/img/favicon/apple-touch-icon-120x120.png">
<meta name="msapplication-square150x150logo" content="../../themes/ecl-fractal-theme/img/favicon/mstile-150x150.png">
<link rel="apple-touch-icon" sizes="57x57" href="../../themes/ecl-fractal-theme/img/favicon/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="152x152" href="../../themes/ecl-fractal-theme/img/favicon/apple-touch-icon-152x152.png">
<meta name="msapplication-square310x310logo" content="../../themes/ecl-fractal-theme/img/favicon/mstile-310x310.png">
<meta name="msapplication-wide310x150logo" content="../../themes/ecl-fractal-theme/img/favicon/mstile-310x150.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../themes/ecl-fractal-theme/img/favicon/apple-touch-icon-114x114.png">
<meta name="msapplication-TileImage" content="../../themes/ecl-fractal-theme/img/favicon/mstile-144x144.png">
<link rel="apple-touch-icon" sizes="180x180" href="../../themes/ecl-fractal-theme/img/favicon/apple-touch-icon-180x180.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../themes/ecl-fractal-theme/img/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="192x192" href="../../themes/ecl-fractal-theme/img/favicon/android-chrome-192x192.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../themes/ecl-fractal-theme/img/favicon/apple-touch-icon-60x60.png">
<link rel="icon" type="image/png" sizes="16x16" href="../../themes/ecl-fractal-theme/img/favicon/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="96x96" href="../../themes/ecl-fractal-theme/img/favicon/favicon-96x96.png">
<link rel="shortcut icon" href="../../themes/ecl-fractal-theme/favicon.ico" type="image/ico">

<link rel="stylesheet" href="../../themes/ecl-fractal-theme/css/fractal.css?cachebust=1.1.0" type="text/css">


<title>Visual regression testing | EC System</title>

</head>
<body class="ecl-typography language-en">
  <div class="ecl-skip-link__wrapper" id="skip-link">
  <a href="#main-content" class="ecl-skip-link">Skip to main content</a>
</div>

<header class="ecl-site-header" role="banner">
  <div class="ecl-site-switcher ecl-site-switcher--header">
    <div class="ecl-container">
      <ul class="ecl-site-switcher__list">
        <li class="ecl-site-switcher__option"><a class="ecl-link ecl-site-switcher__link" href="#">Commission and its priorities</a></li>
        <li class="ecl-site-switcher__option ecl-site-switcher__option--is-selected"><a class="ecl-link ecl-site-switcher__link" href="#">Policies, information and services</a></li>
      </ul>
    </div>
  </div>
  <div class="ecl-container ecl-site-header__banner">
    <a href="https://ec.europa.eu" class="ecl-logo ecl-logo--logotype ecl-site-header__logo" title="Home - European Commission">
      <span class="ecl-u-sr-only">Home - European Commission</span>
    </a>
    <div class="ecl-lang-select-sites ecl-site-header__lang-select-sites">
      <a href="#" class="ecl-lang-select-sites__link">
        <span class="ecl-lang-select-sites__label">English</span>
        <span class="ecl-lang-select-sites__code">
          <span class="ecl-icon ecl-icon--language ecl-lang-select-sites__icon"></span>
          <span class="ecl-lang-select-sites__code-text">en</span>
        </span>
      </a>
    </div>
    <form class="ecl-search-form ecl-site-header__search">
      <label class="ecl-search-form__textfield-wrapper">
        <span class="ecl-u-sr-only">Search this website</span>
        <input type="search" class="ecl-text-input ecl-search-form__textfield" id="search-components" name="search-components" />
        <script id="searchIndexPath" type="application/json">{ "path": "../../assets/searchIndex.json" }</script>
      </label>
      <button class="ecl-button ecl-button--form ecl-search-form__button" type="submit">Search</button>
    </form>
  </div>
</header>
<div class="ecl-page-header">
  <div class="ecl-container">
    <nav class="ecl-breadcrumb " aria-label="breadcrumb">
      <span class="ecl-u-sr-only">You are here:</span>
      <ol class="ecl-breadcrumb__segments-wrapper">
  <li class="ecl-breadcrumb__segment ecl-breadcrumb__segment--first">
    <a href="https://ec.europa.eu/commission/index_en" class="ecl-link ecl-link--inverted ecl-link--standalone ecl-breadcrumb__link">Home</a>
  </li>
  <li class="ecl-breadcrumb__segment ecl-breadcrumb__segment--last">
    <a href="https://ec-europa.github.io/europa-component-library/" class="ecl-link ecl-link--inverted ecl-link--standalone ecl-breadcrumb__link">Europa Component Library</a>
  </li>
  <li class="ecl-breadcrumb__segment ecl-breadcrumb__segment--last">
    <a href="https://ec-europa.github.io/europa-component-library/ec/" class="ecl-link ecl-link--inverted ecl-link--standalone ecl-breadcrumb__link">EC System</a>
  </li>
</ol>

    </nav>
    <div class="ecl-page-header__body">
      <div class="ecl-page-header__identity">
        EC System
      </div>
    </div>
  </div>
</div>

  <main>
    <a id="main-content" tabindex="-1"></a>
    
  <div class="ecl-container-fluid ecl-u-pl-md-none ecl-u-pl-lg-none ecl-u-pl-xl-none">
    <div class="ecl-row">
      <div class="ecl-col-12 ecl-col-md-4 ecl-col-xl-3">
        
<nav class="ecl-side-navigation" aria-label="Main Navigation">
  <button class="ecl-side-navigation__toggle ecl-side-navigation__hamburger ecl-side-navigation__hamburger--squeeze" aria-controls="side-menu-expandable-root" aria-expanded="false">
    <span class="ecl-side-navigation__hamburger-box">
      <span class="ecl-side-navigation__hamburger-inner"></span>
    </span>
    <span class="ecl-side-navigation__hamburger-label">Menu</span>
  </button>
  <ul class="ecl-side-navigation__root" id="side-menu-expandable-root" aria-hidden="true">
    
<li class="ecl-side-navigation__item">
  <a href="#item2" class="ecl-side-navigation__link ecl-expandable__button" aria-controls="nav-menu-expandable-group-3" aria-expanded="false" aria-haspopup="true">Documentation</a>
  <ul class="ecl-side-navigation__group ecl-side-navigation--depth-2" id="nav-menu-expandable-group-3" aria-hidden="true">
    
    
        
        
        <li class="ecl-side-navigation__item"  data-role="item">
          <a href="../overview" class="ecl-side-navigation__link ">
            
            <span>Components</span>
          </a>
        </li>
        
    
        
        
        <li class="ecl-side-navigation__item"  data-role="item">
          <a href="../atomic" class="ecl-side-navigation__link ">
            
            <span>Atomic design patterns</span>
          </a>
        </li>
        
    
        
        
        <li class="ecl-side-navigation__item"  data-role="item">
          <a href="../javascript" class="ecl-side-navigation__link ">
            
            <span>JavaScript</span>
          </a>
        </li>
        
    
        
        
        <li class="ecl-side-navigation__item"  data-role="item">
          <a href="../documentation" class="ecl-side-navigation__link ">
            
            <span>Edit documentation</span>
          </a>
        </li>
        
    
        
        
        <li class="ecl-side-navigation__item"  data-role="item">
          <a href="../systems" class="ecl-side-navigation__link ">
            
            <span>Systems</span>
          </a>
        </li>
        
    
        
        
        <li class="ecl-side-navigation__item"  data-role="item">
          <a href="../presets" class="ecl-side-navigation__link ">
            
            <span>Presets</span>
          </a>
        </li>
        
    
        
        
        <li class="ecl-side-navigation__item"  data-role="item">
          <a href="../developers" class="ecl-side-navigation__link ">
            
            <span>Developers</span>
          </a>
        </li>
        
    
        
        <li class="ecl-side-navigation__item">
          <a href="#item2" class="ecl-side-navigation__link ecl-expandable__button" aria-controls="nav-menu-expandable-group-4" aria-expanded="false" aria-haspopup="true">Conventions</a>
          <ul class="ecl-side-navigation__group ecl-side-navigation--depth-3" id="nav-menu-expandable-group-4" aria-hidden="true">
            
            
            
            
    
        
        
        <li class="ecl-side-navigation__item"  data-role="item">
          <a href="../conventions/component" class="ecl-side-navigation__link ">
            
            <span>Components</span>
          </a>
        </li>
        
    
        
        
        <li class="ecl-side-navigation__item"  data-role="item">
          <a href="../conventions/git" class="ecl-side-navigation__link ">
            
            <span>Git Commit</span>
          </a>
        </li>
        
    
        
        
        <li class="ecl-side-navigation__item"  data-role="item">
          <a href="../conventions/javascript" class="ecl-side-navigation__link ">
            
            <span>JavaScript</span>
          </a>
        </li>
        
    
        
        
        <li class="ecl-side-navigation__item"  data-role="item">
          <a href="../conventions/markdown" class="ecl-side-navigation__link ">
            
            <span>Markdown</span>
          </a>
        </li>
        
    
        
        
        <li class="ecl-side-navigation__item"  data-role="item">
          <a href="../conventions/scss" class="ecl-side-navigation__link ">
            
            <span>SCSS</span>
          </a>
        </li>
        
    
        
        
        <li class="ecl-side-navigation__item"  data-role="item">
          <a href="../conventions/twig" class="ecl-side-navigation__link ">
            
            <span>Twig</span>
          </a>
        </li>
        
    

          </ul>
        </li>
        
    
        
        <li class="ecl-side-navigation__item">
          <a href="#item2" class="ecl-side-navigation__link ecl-expandable__button" aria-controls="nav-menu-expandable-group-4" aria-expanded="false" aria-haspopup="true">Testing</a>
          <ul class="ecl-side-navigation__group ecl-side-navigation--depth-3" id="nav-menu-expandable-group-4" aria-hidden="true">
            
            
            
            
    
        
        
        <li class="ecl-side-navigation__item"  data-state="current" data-role="item">
          <a href="" class="ecl-side-navigation__link  ecl-side-navigation__link--active">
            
            <span>Visual regression</span>
          </a>
        </li>
        
    

          </ul>
        </li>
        
    

  </ul>
</li>

  </ul>
</nav>


      </div>
      <div class="page-content ecl-col-12 ecl-col-md-8 ecl-col-xl-9 ecl-u-mb-s">
        
<div class="ecl-u-mv-m">
  <div class="ecl-u-mb-s">
  
    <h1 class="ecl-heading ecl-heading--h1">Visual regression testing</h1>
    


    
  </div>
  

<div class="ecl-editor">



    
    
    <p>We test our components in order to catch visual regressions before they hit the production. We use <a href="http://webdriver.io/">WebdriverIO</a> to drive those tests on <a href="https://saucelabs.com/">Sauce Labs</a>‘s Selenium cloud-based solution:</p>
<p>Here are the results of the latest build:</p>
<p><a href="https://saucelabs.com/u/europa-component-library"><img src="https://saucelabs.com/browser-matrix/europa-component-library.svg" alt="Build Status"></a></p>
<h2 id="how-to-test-a-new-component">How to test a new component</h2>
<p>Testing a new component is quite simple. Follow the guide!</p>
<h3 id="write-a-test">Write a test</h3>
<p>Tests are located under <code>test/spec</code>. Create a new <code>my-component.js</code> file here and paste:</p>
<code class="lang-js"><pre>describe(<span class="hljs-string">'my-component'</span>, () =&gt; {
  before(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-comment">// Set viewport size</span>
    browser.setViewportSize({
      <span class="hljs-attr">width</span>: <span class="hljs-number">1400</span>,
      <span class="hljs-attr">height</span>: <span class="hljs-number">600</span>,
    });

    browser.pause(<span class="hljs-number">1000</span>);

    <span class="hljs-comment">// Go to the URL of the component</span>
    browser.goToComponent(<span class="hljs-string">'my-component-system'</span>);

    <span class="hljs-comment">// Make sure the browser has finished painting</span>
    browser.pause(<span class="hljs-number">1000</span>);

    <span class="hljs-comment">// Adds necessary scripts for accessibility testing</span>
    browser.injectAxeCore();
  });

  <span class="hljs-comment">// Normal state</span>
  context(<span class="hljs-string">'with plain state'</span>, () =&gt; {
    it(<span class="hljs-string">'should match the reference screenshot'</span>, () =&gt; {
      <span class="hljs-keyword">const</span> screenshots = browser.checkDocument({
        <span class="hljs-attr">name</span>: <span class="hljs-string">'my-component'</span>,
      });
      expect(screenshots).to.matchReference();
    });

    <span class="hljs-comment">// This assertion is mostly the same for each test</span>
    it(<span class="hljs-string">'should be accessible'</span>, () =&gt; {
      <span class="hljs-keyword">const</span> a11yReport = browser.runAxeCore(<span class="hljs-string">'ecl-component-class'</span>).value;
      expect(a11yReport).to.be.accessible;
    });
  });
});</pre></code><p>Of course, replace <code>my-component</code> by the name of the actual component and make sure the URL you provide exists.</p>
<p><strong>Under the hood, the URL will be prefixed by <code>http://localhost:3000/{system}/components/preview/</code></strong>.</p>
<h3 id="get-the-reference-screenshots">Get the reference screenshots</h3>
<p>In order to get the reference screenshots, you have to run the tests locally. On the first run, if the reference screenshots don’t exist, they will be created. You need to create a Sauce Labs account and then create a new token.</p>
<h4 id="configure-sauce-labs">Configure Sauce Labs</h4>
<p>In your <code>.env</code> file, provide the information about your own Sauce Labs account.</p>
<code class="lang-shell"><pre>SAUCE_USERNAME=username
SAUCE_ACCESS_KEY=my-sauce-labs-access-key</pre></code><p>Then, build the style guide with <code>yarn dist</code>.</p>
<h4 id="run-all-the-tests">Run all the tests</h4>
<p>You can run all the tests with the following command:</p>
<code class="lang-shell"><pre>yarn test:functional</pre></code><p>It can take a while to run all the tests, so here come some shortcuts.</p>
<h4 id="run-the-tests-for-the-updated-packages-only">Run the tests for the updated packages only</h4>
<p>Test your changes against the branch you want to merge in with:</p>
<code class="lang-shell"><pre>yarn test:functional --since target-branch</pre></code><p>The list of the updated packages is cached by default the first time it is generated, so if you encounter some strange behaviors, you can force the list to be rebuilt with: <code>--ignoreCache</code>.</p>
<p>Example:</p>
<code class="lang-shell"><pre>yarn test:functional --since v1 --ignoreCache</pre></code><h4 id="run-1-specific-test">Run 1 specific test</h4>
<p>You can also decide to run only one specific test file:</p>
<code class="lang-shell"><pre>yarn test:functional --spec ./src/systems/{system}/components/my-component/test/spec/my-component.js</pre></code><h4 id="target-1-specific-browser">Target 1 specific browser</h4>
<p>Prepend your command with <code>TEST_BROWSER=[browser you want to target]</code> to target 1 specific browser.</p>
<p>Example:</p>
<code class="lang-shell"><pre>TEST_BROWSER=firefox yarn test:functional</pre></code><h5 id="finally">Finally</h5>
<p>If everything went well, you should now have a new folder <code>./src/systems/{system}/components/my-component/test/screenshots/reference/my-component</code> containing the reference screenshots. Add them to your Pull Request.</p>
<p>That’s it!</p>

    


</div>


</div>

      </div>
    </div>
  </div>

  </main>
  <footer class="ecl-footer">
  <div class="ecl-footer__custom">
    <div class="ecl-container">
      <div class="ecl-row">
        <div class="ecl-col-sm ecl-footer__column">
          <h4 class="ecl-heading ecl-heading--h4 ecl-u-mt-xxxs ecl-u-mb-none ecl-footer__custom-title ecl-footer__custom-title-identity">
  Europa Component Library
</h4>

        </div>
        <div class="ecl-col-sm ecl-footer__column">
          <p class="ecl-footer__custom-label">Follow us:</p>
          <ul class="ecl-list ecl-list--unstyled ecl-list--inline ecl-footer__list ecl-footer__list--inline ecl-footer__social-links ecl-u-d-inline">
            <li class="ecl-footer__list-item">
              <a class="ecl-link ecl-footer__link ecl-link--external" href="https://github.com/ec-europa/europa-component-library">GitHub</a>
            </li>
          </ul>
        </div>
        <div class="ecl-col-sm ecl-footer__column">
          <ul class="ecl-list ecl-list--unstyled ecl-footer__list">
            <li class="ecl-footer__list-item">
  <a class="ecl-link ecl-footer__link" href="https://ec-europa.github.io/europa-component-library/ec/docs/overview">Documentation</a>
</li>

          </ul>
        </div>
      </div>
    </div>
  </div>
  <div class="ecl-footer__corporate">
    <div class="ecl-footer__corporate-top">
      <div class="ecl-container">
        <div class="ecl-row">
          <div class="ecl-col-sm ecl-footer__column">
            <h4 class="ecl-h4 ecl-footer__column-title">European Commission</h4>
            <ul class="ecl-list ecl-list--unstyled ecl-footer__list">
              <li class="ecl-footer__list-item">
                <a class="ecl-link ecl-link--inverted ecl-footer__link" href="https://ec.europa.eu/commission/index_en">Commission and its priorities</a>
              </li>
              <li class="ecl-footer__list-item">
                <a class="ecl-link ecl-link--inverted ecl-footer__link" href="https://ec.europa.eu/info/index_en">Policies, information and services</a>
              </li>
            </ul>
          </div>
          <div class="ecl-col-sm ecl-footer__column">
            <h4 class="ecl-h4 ecl-footer__column-title">Follow the European Commission</h4>
            <ul class="ecl-list ecl-list--unstyled ecl-list--inline ecl-footer__list ecl-footer__list--inline  ecl-footer__social-links">
              <li class="ecl-footer__list-item">
                <a class="ecl-link ecl-link--inverted ecl-footer__link" href="#"><span class="ecl-icon ecl-icon--facebook ecl-footer__social-icon"></span>Facebook</a>
              </li>
              <li class="ecl-footer__list-item">
                <a class="ecl-link ecl-link--inverted ecl-footer__link" href="#"><span class="ecl-icon ecl-icon--twitter ecl-footer__social-icon"></span>Twitter</a>
              </li>
              <li class="ecl-footer__list-item">
                <a class="ecl-link ecl-link--inverted ecl-link--external ecl-footer__link" href="#">Other social media</a>
              </li>
            </ul>
          </div>
          <div class="ecl-col-sm ecl-footer__column">
            <h4 class="ecl-h4 ecl-footer__column-title">European Union</h4>
            <ul class="ecl-list ecl-list--unstyled ecl-footer__list">
              <li class="ecl-footer__list-item">
                <a class="ecl-link ecl-link--inverted ecl-link--external ecl-footer__link" href="#">EU institutions</a>
              </li>
              <li class="ecl-footer__list-item">
                <a class="ecl-link ecl-link--inverted ecl-link--external ecl-footer__link" href="#">European Union</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
    <div class="ecl-footer__corporate-bottom">
      <div class="ecl-container">
        <div class="ecl-row">
          <div class="ecl-col-sm ">
            <ul class="ecl-list ecl-list--unstyled ecl-list--inline ecl-footer__list ecl-footer__list--inline">
              <li class="ecl-footer__list-item">
                <a class="ecl-link ecl-link--inverted ecl-footer__link" href="http://ec.europa.eu/info/about-commissions-new-web-presence_en">About the Commission's new web presence</a>
              </li>
              <li class="ecl-footer__list-item">
                <a class="ecl-link ecl-link--inverted ecl-footer__link" href="https://ec.europa.eu/info/language-policy_en">Language policy</a>
              </li>
              <li class="ecl-footer__list-item">
                <a class="ecl-link ecl-link--inverted ecl-footer__link" href="http://ec.europa.eu/info/resources-partners_en">Resources for partners</a>
              </li>
              <li class="ecl-footer__list-item">
                <a class="ecl-link ecl-link--inverted ecl-footer__link" href="http://ec.europa.eu/info/cookies_en">Cookies</a>
              </li>
              <li class="ecl-footer__list-item">
                <a class="ecl-link ecl-link--inverted ecl-footer__link" href="https://ec.europa.eu/info/privacy-policy_en">Privacy policy</a>
              </li>
              <li class="ecl-footer__list-item">
                <a class="ecl-link ecl-link--inverted ecl-footer__link" href="http://ec.europa.eu/info/legal-notice_en">Legal notice</a>
              </li>
              <li class="ecl-footer__list-item">
                <a class="ecl-link ecl-link--inverted ecl-footer__link" href="http://ec.europa.eu/info/contact_en">Contact</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</footer>

<script src="../../themes/ecl-fractal-theme/js/jquery.min.js?cachebust=1.1.0"></script>

<script src="../../themes/ecl-fractal-theme/js/jquery-resizable.min.js?cachebust=1.1.0"></script>

<script src="../../themes/ecl-fractal-theme/js/select2.min.js?cachebust=1.1.0"></script>

<script src="../../themes/ecl-fractal-theme/js/ecl-fractal-theme.js?cachebust=1.1.0"></script>



</body>
</html>
